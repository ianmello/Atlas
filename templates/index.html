<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Qual é o seu próximo destino?</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
<style>
   * {
     margin: 0;
     padding: 0;
     box-sizing: border-box;
     font-family: 'Poppins', sans-serif;
   }
   html,
   body {
     height: 100%;
     font-family: Arial, sans-serif;
     color: white;
   }
   .navbar {
     width: 100vw;
     height: 80px;
     background: rgba(0, 0, 0, 0.45);
     display: flex;
     align-items: center;
     justify-content: space-between;
     position: fixed;
     top: 0;
     left: 0;
     z-index: 10;
     padding: 0 40px;
     box-sizing: border-box;
   }
   .navbar-logo img {
     height: 100px;
     max-height: 130px;
     width: auto;
     display: block;
   }
   .navbar-links {
     display: flex;
     gap: 24px;
   }
   .navbar-link {
     color: #fff;
     font-family: 'Poppins', sans-serif;
     font-weight: 600;
     font-size: 1.1rem;
     text-decoration: none;
     padding: 8px 18px;
     border-radius: 8px;
     transition: background 0.2s;
   }
   .navbar-link:hover {
     background: rgba(255, 255, 255, 0.12);
   }
   @media (max-width: 700px) {
     .navbar {
       padding: 0 10px;
       height: 60px;
     }
     .navbar-logo img {
       height: 50px;
     }
     .navbar-link {
       font-size: 0.95rem;
       padding: 6px 10px;
     }
   }
   .container {
     position: relative;
     display: flex;
     flex-direction: column;
     justify-content: center;
     align-items: center;
     padding: 0 10px;
     text-align: center;
     z-index: 1;
     opacity: 1;
     transition: opacity 0.1s ease-out;
     padding-top: 80px;
     min-height: 100vh;
     padding-bottom: 50px;
   }
   .container.fade-out {
     opacity: 0;
   }
   h1 {
     font-weight: 900;
     font-family: 'Poppins', sans-serif;
     font-size: 4.5rem;
     line-height: 1.1;
     text-transform: uppercase;
     max-width: 700px;
     margin-bottom: 30px;
   }

   /* Painel de Busca Estruturado */
   .search-panel {
     background: rgba(255, 255, 255, 0.95);
     border-radius: 20px;
     padding: 25px;
     box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
     max-width: 1200px;
     width: calc(100% - 40px);
     margin: 30px auto;
     backdrop-filter: blur(10px);
     overflow: visible;
     position: relative;
     box-sizing: border-box;
   }

   .search-form {
     display: grid;
     grid-template-columns: 1fr 1fr 1.5fr 200px;
     grid-template-rows: auto auto;
     gap: 20px;
     width: 100%;
     margin-bottom: 15px;
   }

   .form-group {
     position: relative;
   }
   
   .form-group:first-child {
     grid-column: 1;
     grid-row: 1;
   }

   .form-group:nth-child(2) {
     grid-column: 2;
     grid-row: 1;
   }

   .form-group label {
     display: block;
     color: #555;
     font-weight: 600;
     margin-bottom: 8px;
     font-size: 0.9rem;
   }

   .form-control {
     width: 100%;
     padding: 12px 15px;
     border: 2px solid #e0e0e0;
     border-radius: 12px;
     font-size: 1rem;
     font-family: 'Poppins', sans-serif;
     transition: all 0.3s ease;
     background: white;
     color: #333;
   }

   .form-control:focus {
     outline: none;
     border-color: #4285f4;
     box-shadow: 0 0 0 3px rgba(66, 133, 244, 0.1);
   }

   .form-control.with-icon {
     padding-left: 45px;
   }

   .input-icon {
     position: absolute;
     left: 15px;
     top: 50%;
     transform: translateY(-50%);
     color: #888;
     font-size: 1.1rem;
   }

   .date-group {
     display: flex;
     gap: 15px;
     grid-column: 3;
     grid-row: 1;
   }

   .travelers-group {
     width: 200px;
     position: relative;
     grid-column: 4;
     grid-row: 1;
   }

   .travelers-selector {
     background: white;
     border: 2px solid #e0e0e0;
     border-radius: 12px;
     padding: 12px 15px;
     cursor: pointer;
     display: flex;
     align-items: center;
     justify-content: space-between;
     transition: all 0.3s ease;
     width: 100%;
   }

   .travelers-selector:hover {
     border-color: #4285f4;
   }

   .travelers-info {
     display: flex;
     align-items: center;
     gap: 8px;
     color: #333;
     font-weight: 500;
   }

   .travelers-dropdown {
     position: absolute;
     top: 100%;
     left: 0;
     right: 0;
     background: white;
     border-radius: 12px;
     box-shadow: 0 5px 20px rgba(0, 0, 0, 0.15);
     padding: 20px;
     z-index: 1000;
     display: none;
     margin-top: 5px;
     border: 1px solid #e0e0e0;
     min-width: 280px;
     width: 100%;
     box-sizing: border-box;
   }

   .travelers-dropdown.show {
     display: block;
   }

   .traveler-row {
     display: flex;
     justify-content: space-between;
     align-items: center;
     padding: 12px 0;
     border-bottom: 1px solid #f0f0f0;
   }

   .traveler-row:last-child {
     border-bottom: none;
   }

   .traveler-label {
     color: #333;
     font-weight: 500;
   }

   .counter-controls {
     display: flex;
     align-items: center;
     gap: 15px;
   }

   .counter-btn {
     width: 32px;
     height: 32px;
     border-radius: 50%;
     border: 2px solid #e0e0e0;
     background: white;
     display: flex;
     align-items: center;
     justify-content: center;
     cursor: pointer;
     transition: all 0.3s ease;
     color: #666;
   }

   .counter-btn:hover:not(.disabled) {
     border-color: #4285f4;
     color: #4285f4;
   }

   .counter-btn.disabled {
     opacity: 0.4;
     cursor: not-allowed;
   }

   .counter-value {
     font-weight: 600;
     color: #333;
     min-width: 20px;
     text-align: center;
   }

   .search-options {
     display: flex;
     gap: 20px;
     align-items: center;
     flex-wrap: wrap;
     flex: 1;
   }

   .checkbox-group {
     display: flex;
     align-items: center;
     gap: 8px;
     cursor: pointer;
   }

   .checkbox-group input[type="checkbox"] {
     width: 18px;
     height: 18px;
     accent-color: #4285f4;
   }

   .checkbox-group label {
     color: #555;
     cursor: pointer;
     margin: 0;
     font-size: 0.95rem;
   }

   .search-button {
     background: linear-gradient(135deg, #4285f4, #34a853);
     color: white;
     border: none;
     border-radius: 12px;
     padding: 15px 30px;
     font-size: 1.1rem;
     font-weight: 600;
     cursor: pointer;
     transition: all 0.3s ease;
     display: flex;
     align-items: center;
     gap: 8px;
     min-width: 150px;
     justify-content: center;
     flex-shrink: 0;
     align-self: flex-end;
   }

       .search-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(66, 133, 244, 0.3);
    }

    .search-button:disabled {
      opacity: 0.7;
      cursor: not-allowed;
      transform: none;
    }

    .form-group.error .form-control {
      border-color: #dc3545;
      box-shadow: 0 0 0 3px rgba(220, 53, 69, 0.1);
    }

    .error-message {
      color: #dc3545;
      font-size: 0.8rem;
      margin-top: 5px;
      display: none;
    }

    .form-group.error .error-message {
      display: block;
    }

    /* Animações suaves */
    .search-panel {
      animation: slideUp 0.6s ease-out;
    }

    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .travelers-dropdown {
      animation: fadeIn 0.3s ease-out;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: scale(0.95);
      }
      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    /* Grid layout - mais estável que flexbox */
    .search-form > * {
      box-sizing: border-box;
    }
    
    .search-button {
      background: linear-gradient(135deg, #4285f4, #34a853);
      color: white;
      border: none;
      border-radius: 12px;
      padding: 15px 40px;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
      white-space: nowrap;
      justify-content: center;
      grid-column: 1 / -1;
      grid-row: 2;
      justify-self: center;
      max-width: 200px;
    }
    
    .search-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(66, 133, 244, 0.3);
    }
    
    .search-button:disabled {
      opacity: 0.7;
      cursor: not-allowed;
      transform: none;
    }

   /* Media queries simplificadas */
   @media (min-width: 1024px) {
     .search-form {
       gap: 25px;
     }
   }

   @media (min-width: 769px) and (max-width: 1023px) {
     .search-form {
       grid-template-columns: 1fr 1fr 1.2fr 180px;
       gap: 18px;
     }
     
     .travelers-group {
       width: 180px;
     }
     
     .search-button {
       padding: 12px 30px;
       font-size: 1rem;
     }
   }

   @media (max-width: 768px) {
     h1 {
       font-size: 2.5rem;
     }
     
     .search-panel {
       margin: 20px 10px;
       padding: 20px;
     }
     
     .search-form {
       display: flex;
       flex-direction: column;
       gap: 15px;
     }
     
     .form-group,
     .date-group,
     .travelers-group {
       width: 100%;
     }
     
     .date-group {
       flex-direction: column;
       gap: 15px;
     }
     
     .search-button {
       width: 100%;
       max-width: 300px;
       margin: 10px auto 0;
     }
     
     .search-options {
       justify-content: center;
       width: 100%;
     }

     .travelers-dropdown {
       left: -15px;
       right: -15px;
       min-width: auto;
     }
   }

   .background-layer {
     position: absolute;
     top: 0;
     left: 0;
     width: 100%;
     height: 100%;
     background-size: cover;
     background-position: center;
     transition: opacity 1s ease-in-out;
     z-index: -1;
     opacity: 0;
   }
   
   .background-layer.active {
     opacity: 1;
   }

   .how-it-works-section {
     padding: 60px 20px;
     background-color: #f9f9f9;
     text-align: center;
     font-family: 'Arial', sans-serif;
     color: #333;
   }
   
   .how-it-works-section .container {
     max-width: 1200px;
     margin: 0 auto;
   }
   
   .how-it-works-section h2 {
     font-size: 2.5em;
     margin-bottom: 50px;
     color: #333;
   }
   
   .steps-container {
     display: flex;
     justify-content: center;
     gap: 30px;
     flex-wrap: wrap;
   }
   
   .step-item {
     background-color: #fff;
     border-radius: 10px;
     padding: 30px;
     box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
     flex: 1;
     min-width: 280px;
     max-width: 400px;
     display: flex;
     flex-direction: column;
     align-items: center;
     text-align: center;
     transition: transform 0.3s ease, box-shadow 0.3s ease;
   }
   
   .step-item:hover {
     transform: translateY(-5px);
     box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
   }
   
   .step-number {
     background-color: #3b3d46;
     color: #fff;
     border-radius: 50%;
     width: 60px;
     height: 60px;
     display: flex;
     justify-content: center;
     align-items: center;
     font-size: 2em;
     font-weight: bold;
     margin-bottom: 20px;
   }
   
   .step-item h3 {
     font-size: 1.5em;
     margin-bottom: 15px;
     color: #555;
   }
   
   .step-item p {
     font-size: 1.05em;
     line-height: 1.6;
     color: #666;
   }
   
   .cta-button {
     display: inline-block;
     background-color: #3b3d46;
     color: #fff;
     padding: 15px 30px;
     border-radius: 5px;
     text-decoration: none;
     font-size: 1.2em;
     font-weight: bold;
     margin-top: 50px;
     transition: background-color 0.3s ease, transform 0.2s ease;
   }
   
   .cta-button:hover {
     background-color: #646672;
     transform: translateY(-2px);
   }
   
   @media (max-width: 768px) {
     .steps-container {
       flex-direction: column;
       align-items: center;
     }
     
     .step-item {
       max-width: 90%;
     }
     
     .how-it-works-section h2 {
       font-size: 2em;
     }
     
     .cta-button {
       width: 100%;
       box-sizing: border-box;
     }
   }
</style>
</head>
<body>
<nav class="navbar">
<div class="navbar-logo">
<img src="{{ url_for('static', filename='atlas_logo.png') }}" alt="Atlas Logo" />
</div>
<div class="navbar-links">
<a href="#" class="navbar-link">Login</a>
<a href="#" class="navbar-link">Cadastre-se</a>
</div>
</nav>

<div id="bg1" class="background-layer active"></div>
<div id="bg2" class="background-layer"></div>

<div class="container" id="bg-container">
<h1>QUAL SERÁ SEU<br>PRÓXIMO<br>DESTINO?</h1>

<div class="search-panel">
    <form class="search-form" id="travel-form">
                 <!-- Origem -->
         <div class="form-group" id="origin-group">
             <label for="origin">De onde você vem?</label>
             <div style="position: relative;">
                 <i class="fas fa-home input-icon"></i>
                 <input type="text" 
                        id="origin" 
                        name="origin" 
                        class="form-control with-icon" 
                        placeholder="Ex: São Paulo, Rio de Janeiro..."
                        required>
             </div>
             <div class="error-message" id="origin-error">Por favor, informe a cidade de origem</div>
         </div>

                 <!-- Destino -->
         <div class="form-group" id="destination-group">
             <label for="destination">Para onde você vai?</label>
             <div style="position: relative;">
                 <i class="fas fa-map-marker-alt input-icon"></i>
                 <input type="text" 
                        id="destination" 
                        name="destination" 
                        class="form-control with-icon" 
                        placeholder="Ex: Paris, São Paulo, Japão..."
                        required>
             </div>
             <div class="error-message" id="destination-error">Por favor, informe o destino da viagem</div>
         </div>

                 <!-- Datas -->
         <div class="form-group date-group">
             <div style="flex: 1;" id="checkin-group">
                 <label for="checkin">Data de ida</label>
                 <div style="position: relative;">
                     <i class="fas fa-calendar input-icon"></i>
                     <input type="date" 
                            id="checkin" 
                            name="checkin" 
                            class="form-control with-icon"
                            required>
                 </div>
                 <div class="error-message" id="checkin-error">Por favor, informe a data de ida</div>
             </div>
             <div style="flex: 1;" id="checkout-group">
                 <label for="checkout">Data de volta (opcional)</label>
                 <div style="position: relative;">
                     <i class="fas fa-calendar input-icon"></i>
                     <input type="date" 
                            id="checkout" 
                            name="checkout" 
                            class="form-control with-icon">
                 </div>
                 <div class="error-message" id="checkout-error">Data de volta deve ser posterior à data de ida</div>
             </div>
         </div>

        <!-- Viajantes -->
        <div class="form-group travelers-group">
            <label>Viajantes</label>
            <div class="travelers-selector" onclick="toggleTravelersDropdown()">
                <div class="travelers-info">
                    <i class="fas fa-user"></i>
                    <span id="travelers-display">2 adultos • 0 crianças</span>
                </div>
                <i class="fas fa-chevron-down"></i>
            </div>
            
            <div class="travelers-dropdown" id="travelers-dropdown">
                <div class="traveler-row">
                    <div class="traveler-label">Adultos</div>
                    <div class="counter-controls">
                        <button type="button" class="counter-btn" onclick="changeTravelers('adults', -1)">
                            <i class="fas fa-minus"></i>
                        </button>
                        <span class="counter-value" id="adults-count">2</span>
                        <button type="button" class="counter-btn" onclick="changeTravelers('adults', 1)">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                </div>
                <div class="traveler-row">
                    <div class="traveler-label">Crianças</div>
                    <div class="counter-controls">
                        <button type="button" class="counter-btn" onclick="changeTravelers('children', -1)">
                            <i class="fas fa-minus"></i>
                        </button>
                        <span class="counter-value" id="children-count">0</span>
                        <button type="button" class="counter-btn" onclick="changeTravelers('children', 1)">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Botão de Pesquisa -->
        <button type="submit" class="search-button">
            <i class="fas fa-search"></i>
            Pesquisar
        </button>
    </form>

    <!-- Opções de Busca -->
    <div class="search-options">
        <div class="checkbox-group">
            <input type="checkbox" id="include-flights" name="include-flights" checked>
            <label for="include-flights">Incluir informações de voos</label>
        </div>
        <div class="checkbox-group">
            <input type="checkbox" id="include-hotels" name="include-hotels">
            <label for="include-hotels">Incluir sugestões de hospedagem</label>
        </div>
        <div class="checkbox-group">
            <input type="checkbox" id="include-weather" name="include-weather" checked>
            <label for="include-weather">Incluir previsão do tempo</label>
        </div>
    </div>
</div>
</div>

<section class="how-it-works-section">
<div class="container">
<h2>Porque usar o Atlas?</h2>
<div class="steps-container">
<div class="step-item">
<div class="step-number">1</div>
<h3>Economia do seu Tempo</h3>
<p>Compartilhe seus interesses, destinos desejados, orçamento e o que você busca na sua aventura. Quanto mais
           detalhes, mais personalizado será o resultado! O Atlas analisa suas preferências em segundos, gerando um
           roteiro detalhado e otimizado com opções de hospedagem, voos e atividades, tudo pensado para você.</p>
</div>
<div class="step-item">
<div class="step-number">2</div>
<h3>Roteiro personalizado</h3>
<p>Roteiros genéricos não atendem às necessidades individuais. Cada viajante tem gostos, orçamentos e estilos
           diferentes. O Atlas se adapta às preferências do usuário, criando roteiros realmente únicos.</p>
</div>
<div class="step-item">
<div class="step-number">3</div>
<h3>Tudo em Um</h3>
<p>Ter que usar vários aplicativos e sites para reservar voos, hotéis, atividades, e ainda gerenciar o
           orçamento separadamente. O Atlas agrega todas essas informações em um só lugar</p>
</div>
<div class="step-item">
<div class="step-number">4</div>
<h3>Experiências Únicas</h3>
<p>Perder oportunidades de experiências ou lugares escondidos porque não se tem tempo ou conhecimento para
           pesquisá-las. Podemos sugerir coisas que o usuário nem sabia que existiam, otimizando a viagem.</p>
</div>
</div>
<a href="#" class="cta-button">Planeje Sua Viagem Agora</a>
</div>
</section>

<script>
   const backgrounds = [
     'https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=1470&q=80',
     'https://images.unsplash.com/photo-1507525428034-b723cf961d3e?fm=jpg&q=60&w=3000',
     'https://images.unsplash.com/photo-1498307833015-e7b400441eb8?fm=jpg&q=60&w=3000',
     'https://images.unsplash.com/photo-1528164344705-47542687000d?fm=jpg&q=60&w=3000'
   ];

   let current = 0;
   let activeIndex = 0;
   const bgElements = [document.getElementById('bg1'), document.getElementById('bg2')];
   const container = document.getElementById('bg-container');

   // Configurar data mínima como hoje
   const today = new Date().toISOString().split('T')[0];
   document.getElementById('checkin').min = today;
   document.getElementById('checkout').min = today;

       // Atualizar data mínima de volta quando ida é alterada
    document.getElementById('checkin').addEventListener('change', function() {
        document.getElementById('checkout').min = this.value;
        // Limpar erro de data se válida
        if (this.value) {
            const checkinGroup = document.getElementById('checkin-group');
            if (checkinGroup) checkinGroup.classList.remove('error');
        }
    });

    // Validação em tempo real para origem
    document.getElementById('origin').addEventListener('input', function() {
        if (this.value.trim()) {
            const originGroup = document.getElementById('origin-group');
            if (originGroup) originGroup.classList.remove('error');
        }
    });

    // Validação em tempo real para destino
    document.getElementById('destination').addEventListener('input', function() {
        if (this.value.trim()) {
            const destinationGroup = document.getElementById('destination-group');
            if (destinationGroup) destinationGroup.classList.remove('error');
        }
    });

    // Validação em tempo real para data de volta
    document.getElementById('checkout').addEventListener('change', function() {
        const checkin = document.getElementById('checkin').value;
        const checkout = this.value;
        
        if (checkin && checkout) {
            const checkinDate = new Date(checkin);
            const checkoutDate = new Date(checkout);
            
            const checkoutGroup = document.getElementById('checkout-group');
            if (checkoutDate > checkinDate) {
                if (checkoutGroup) checkoutGroup.classList.remove('error');
            }
        }
    });

   function changeBackground() {
     const next = (current + 1) % backgrounds.length;
     const nextBg = bgElements[1 - activeIndex];
     const currentBg = bgElements[activeIndex];
     
     nextBg.style.backgroundImage = `url('${backgrounds[next]}')`;
     nextBg.classList.add('active');
     currentBg.classList.remove('active');
     
     current = next;
     activeIndex = 1 - activeIndex;
   }

   function toggleTravelersDropdown() {
       console.log('Toggle dropdown clicked'); // Debug
       const dropdown = document.getElementById('travelers-dropdown');
       if (dropdown) {
           dropdown.classList.toggle('show');
           console.log('Dropdown classes:', dropdown.className); // Debug
       } else {
           console.log('Dropdown element not found'); // Debug
       }
   }

   // Fechar dropdown ao clicar fora
   document.addEventListener('click', function(e) {
       const dropdown = document.getElementById('travelers-dropdown');
       const selector = document.querySelector('.travelers-selector');
       
       if (!selector.contains(e.target) && !dropdown.contains(e.target)) {
           dropdown.classList.remove('show');
       }
   });

   let travelers = {
       adults: 2,
       children: 0
   };

   function changeTravelers(type, change) {
       travelers[type] += change;
       
       if (travelers[type] < 0) travelers[type] = 0;
       if (type === 'adults' && travelers[type] < 1) travelers[type] = 1;
       if (travelers[type] > 10) travelers[type] = 10;
       
       document.getElementById(type + '-count').textContent = travelers[type];
       updateTravelersDisplay();
       updateCounterButtons();
   }

   function updateTravelersDisplay() {
       const display = document.getElementById('travelers-display');
       let text = `${travelers.adults} adulto${travelers.adults !== 1 ? 's' : ''}`;
       if (travelers.children > 0) {
           text += ` • ${travelers.children} criança${travelers.children !== 1 ? 's' : ''}`;
       }
       display.textContent = text;
   }

   function updateCounterButtons() {
       const adultMinus = document.querySelector('.counter-controls .counter-btn');
       const buttons = document.querySelectorAll('.counter-btn');
       
       buttons.forEach((btn, index) => {
           const type = index < 2 ? 'adults' : 'children';
           const isDecrease = index % 2 === 0;
           
           if (isDecrease) {
               if ((type === 'adults' && travelers.adults <= 1) || 
                   (type === 'children' && travelers.children <= 0)) {
                   btn.classList.add('disabled');
               } else {
                   btn.classList.remove('disabled');
               }
           } else {
               if (travelers[type] >= 10) {
                   btn.classList.add('disabled');
               } else {
                   btn.classList.remove('disabled');
               }
           }
       });
   }

   function generateSearchQuery() {
       const origin = document.getElementById('origin').value.trim();
       const destination = document.getElementById('destination').value.trim();
       const checkin = document.getElementById('checkin').value;
       const checkout = document.getElementById('checkout').value;
       const includeFlights = document.getElementById('include-flights').checked;
       const includeHotels = document.getElementById('include-hotels').checked;
       const includeWeather = document.getElementById('include-weather').checked;

       if (!origin) {
           alert('Por favor, informe a cidade de origem');
           return null;
       }

       if (!destination) {
           alert('Por favor, informe o destino da viagem');
           return null;
       }

       if (!checkin) {
           alert('Por favor, informe a data de ida');
           return null;
       }

       // Calcular duração da viagem
       let duration = '';
       if (checkout) {
           const startDate = new Date(checkin);
           const endDate = new Date(checkout);
           const days = Math.ceil((endDate - startDate) / (1000 * 60 * 60 * 24));
           if (days > 0) {
               duration = ` por ${days} dia${days !== 1 ? 's' : ''}`;
           }
       }

       // Construir a query naturalemente
       let query = `Quero um roteiro de viagem de ${origin} para ${destination}${duration}`;
       
       if (checkin) {
           const startDate = new Date(checkin);
           const formattedDate = startDate.toLocaleDateString('pt-BR');
           query += ` saindo no dia ${formattedDate}`;
       }

       if (travelers.adults > 1 || travelers.children > 0) {
           query += ` para ${travelers.adults} adulto${travelers.adults !== 1 ? 's' : ''}`;
           if (travelers.children > 0) {
               query += ` e ${travelers.children} criança${travelers.children !== 1 ? 's' : ''}`;
           }
       }

       // Adicionar preferências
       const preferences = [];
       if (includeFlights) preferences.push('incluir informações de voos');
       if (includeHotels) preferences.push('sugestões de hospedagem');
       if (includeWeather) preferences.push('previsão do tempo');

       if (preferences.length > 0) {
           query += '. Por favor, ' + preferences.join(', ');
       }

       return query;
   }

       function clearValidationErrors() {
        document.querySelectorAll('.form-group.error').forEach(group => {
            group.classList.remove('error');
        });
    }

    function showValidationError(fieldId, message) {
        const group = document.getElementById(fieldId + '-group');
        const errorElement = document.getElementById(fieldId + '-error');
        
        if (group) group.classList.add('error');
        if (errorElement && message) errorElement.textContent = message;
    }

    function validateForm() {
        clearValidationErrors();
        let isValid = true;

        const origin = document.getElementById('origin').value.trim();
        const destination = document.getElementById('destination').value.trim();
        const checkin = document.getElementById('checkin').value;
        const checkout = document.getElementById('checkout').value;

        // Validar origem
        if (!origin) {
            showValidationError('origin', 'Por favor, informe a cidade de origem');
            isValid = false;
        }

        // Validar destino
        if (!destination) {
            showValidationError('destination', 'Por favor, informe o destino da viagem');
            isValid = false;
        }

        // Validar data de ida
        if (!checkin) {
            showValidationError('checkin', 'Por favor, informe a data de ida');
            isValid = false;
        } else {
            // Verificar se a data não é no passado
            const today = new Date();
            const checkinDate = new Date(checkin);
            today.setHours(0, 0, 0, 0);
            
            if (checkinDate < today) {
                showValidationError('checkin', 'A data de ida não pode ser no passado');
                isValid = false;
            }
        }

        // Validar data de volta se informada
        if (checkout && checkin) {
            const checkinDate = new Date(checkin);
            const checkoutDate = new Date(checkout);
            
            if (checkoutDate <= checkinDate) {
                showValidationError('checkout', 'A data de volta deve ser posterior à data de ida');
                isValid = false;
            }
        }

        return isValid;
    }

    function performStructuredSearch() {
        if (!validateForm()) {
            return;
        }

        const searchData = {
            origin: document.getElementById('origin').value.trim(),
            destination: document.getElementById('destination').value.trim(),
            checkin: document.getElementById('checkin').value,
            checkout: document.getElementById('checkout').value,
            adults: travelers.adults,
            children: travelers.children,
            includeFlights: document.getElementById('include-flights').checked,
            includeHotels: document.getElementById('include-hotels').checked,
            includeWeather: document.getElementById('include-weather').checked
        };

        // Mostrar loading
        const submitBtn = document.querySelector('.search-button');
        const originalText = submitBtn.innerHTML;
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processando...';
        submitBtn.disabled = true;

        // Armazenar dados para processamento no chat
        localStorage.setItem('pendingSearchData', JSON.stringify(searchData));
        
        // Redirecionar imediatamente para o chat
        window.location.href = '/chat';
    }

    function redirectToChat(message) {
        localStorage.setItem('pendingMessage', message);
        window.location.href = '/chat';
    }

    // Inicialização
    bgElements[activeIndex].style.backgroundImage = `url('${backgrounds[current]}')`;
    setInterval(changeBackground, 8000);
    updateCounterButtons();

    // Event listeners
    document.getElementById('travel-form').addEventListener('submit', function(e) {
        e.preventDefault();
        container.classList.add('fade-out');
        setTimeout(() => performStructuredSearch(), 300);
    });

   window.addEventListener('pageshow', function(event) {
       container.classList.remove('fade-out');
   });
</script>
</body>
</html>
